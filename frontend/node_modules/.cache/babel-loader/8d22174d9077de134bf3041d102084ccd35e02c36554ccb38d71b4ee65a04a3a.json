{"ast":null,"code":"import _objectSpread from\"C:/Users/mrydu/Documents/GitHub/Projekt-Chmury-Bezpieczenstwo/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// src/App.js\nimport React,{useEffect,useState}from'react';import keycloak from'./keycloak';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function App(){const[auth,setAuth]=useState(false);const[products,setProducts]=useState([]);const[cart,setCart]=useState([]);// const [users, setUsers] = useState([]);   // ‚Üê mo≈ºna usunƒÖƒá lub zostawiƒá nieu≈ºywane\nuseEffect(()=>{keycloak.init({onLoad:'login-required',checkLoginIframe:false,pkceMethod:'S256'}).then(authenticated=>{if(!authenticated)return;setAuth(true);// Wydrukuj token do konsoli i przypisz do window, ≈ºeby by≈Ço ≈Çatwo skopiowaƒá\nconsole.log('üí† Keycloak token:',keycloak.token);window.kcToken=keycloak.token;// PRODUCTS\nfetch('/products',{headers:{Authorization:'Bearer '+keycloak.token}}).then(r=>r.ok?r.json():[]).then(data=>setProducts(Array.isArray(data)?data.map(p=>_objectSpread(_objectSpread({},p),{},{price:Number(p.price)})):[])).catch(()=>setProducts([]));// KC-USERS ‚Äì tymczasowo wy≈ÇƒÖczone\n// fetch('/kc-users', {\n//   headers: { Authorization: 'Bearer ' + keycloak.token }\n// })\n//   .then(r => r.ok ? r.json() : [])\n//   .then(setUsers)\n//   .catch(() => setUsers([]));\n});},[]);const addToCart=p=>{setCart(prev=>{const idx=prev.findIndex(c=>c.productId===p.id);if(idx>=0){// ju≈º jest ‚Üí tylko zwiƒôkszamy qty\nconst updated=[...prev];updated[idx]=_objectSpread(_objectSpread({},updated[idx]),{},{qty:updated[idx].qty+1});return updated;}// nowy wpis\nreturn[...prev,{productId:p.id,name:p.name,price:p.price,qty:1}];});};const checkout=()=>{fetch('/orders',{method:'POST',headers:{'Content-Type':'application/json',Authorization:'Bearer '+keycloak.token},body:JSON.stringify({items:cart.map(c=>({productId:c.productId,quantity:c.qty}))})}).then(r=>r.json()).then(o=>alert('Zam√≥wienie #'+o.orderId+' utworzone!')).catch(()=>alert('B≈ÇƒÖd zam√≥wienia'));};if(!auth)return/*#__PURE__*/_jsx(\"div\",{children:\"\\u0141adowanie...\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"flex-container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Sklepik\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"products\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Produkty\"}),/*#__PURE__*/_jsx(\"ul\",{children:products.map(p=>/*#__PURE__*/_jsxs(\"li\",{children:[p.name,\" \\u2013 \",p.price.toFixed(2),\" z\\u0142\",/*#__PURE__*/_jsx(\"button\",{onClick:()=>addToCart(p),children:\"Dodaj\"})]},p.id))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Koszyk\"}),/*#__PURE__*/_jsx(\"ul\",{children:cart.map(c=>/*#__PURE__*/_jsxs(\"li\",{children:[c.name,\" x\",c.qty,\" \\u2013 \",(c.price*c.qty).toFixed(2),\" z\\u0142\"]},c.productId))}),cart.length>0&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{onClick:checkout,children:\"Zam\\xF3w\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart-total\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Suma: \"}),cart.reduce((sum,c)=>sum+c.price*c.qty,0).toFixed(2),\" z\\u0142\"]})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>keycloak.logout(),children:\"Wyloguj\"})]});}export default App;","map":{"version":3,"names":["React","useEffect","useState","keycloak","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","App","auth","setAuth","products","setProducts","cart","setCart","init","onLoad","checkLoginIframe","pkceMethod","then","authenticated","console","log","token","window","kcToken","fetch","headers","Authorization","r","ok","json","data","Array","isArray","map","p","_objectSpread","price","Number","catch","addToCart","prev","idx","findIndex","c","productId","id","updated","qty","name","checkout","method","body","JSON","stringify","items","quantity","o","alert","orderId","children","className","toFixed","onClick","length","reduce","sum","logout"],"sources":["C:/Users/mrydu/Documents/GitHub/Projekt-Chmury-Bezpieczenstwo/frontend/src/app.js"],"sourcesContent":["// src/App.js\r\nimport React, { useEffect, useState } from 'react';\r\nimport keycloak from './keycloak';\r\n\r\nfunction App() {\r\n  const [auth, setAuth] = useState(false);\r\n  const [products, setProducts] = useState([]);\r\n  const [cart, setCart] = useState([]);\r\n  // const [users, setUsers] = useState([]);   // ‚Üê mo≈ºna usunƒÖƒá lub zostawiƒá nieu≈ºywane\r\n\r\n  useEffect(() => {\r\n    keycloak\r\n      .init({ onLoad: 'login-required', checkLoginIframe: false, pkceMethod: 'S256' })\r\n      .then((authenticated) => {\r\n        if (!authenticated) return;\r\n        setAuth(true);\r\n\r\n        // Wydrukuj token do konsoli i przypisz do window, ≈ºeby by≈Ço ≈Çatwo skopiowaƒá\r\n        console.log('üí† Keycloak token:', keycloak.token);\r\n        window.kcToken = keycloak.token;\r\n\r\n        // PRODUCTS\r\n        fetch('/products', {\r\n          headers: { Authorization: 'Bearer ' + keycloak.token }\r\n        })\r\n          .then(r => r.ok ? r.json() : [])\r\n          .then(data => setProducts(\r\n            Array.isArray(data)\r\n              ? data.map(p => ({ ...p, price: Number(p.price) }))\r\n              : []\r\n          ))\r\n          .catch(() => setProducts([]));\r\n\r\n        // KC-USERS ‚Äì tymczasowo wy≈ÇƒÖczone\r\n        // fetch('/kc-users', {\r\n        //   headers: { Authorization: 'Bearer ' + keycloak.token }\r\n        // })\r\n        //   .then(r => r.ok ? r.json() : [])\r\n        //   .then(setUsers)\r\n        //   .catch(() => setUsers([]));\r\n      });\r\n  }, []);\r\n\r\n  const addToCart = p => {\r\n    setCart(prev => {\r\n      const idx = prev.findIndex(c => c.productId === p.id);\r\n      if (idx >= 0) {\r\n        // ju≈º jest ‚Üí tylko zwiƒôkszamy qty\r\n        const updated = [...prev];\r\n        updated[idx] = { \r\n          ...updated[idx], \r\n          qty: updated[idx].qty + 1 \r\n        };\r\n        return updated;\r\n      }\r\n      // nowy wpis\r\n      return [...prev, { productId: p.id, name: p.name, price: p.price, qty: 1 }];\r\n    });\r\n  };\r\n\r\n  const checkout = () => {\r\n    fetch('/orders', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        Authorization: 'Bearer ' + keycloak.token\r\n      },\r\n      body: JSON.stringify({ items: cart.map(c=>({ productId: c.productId, quantity: c.qty })) })\r\n    })\r\n      .then(r => r.json())\r\n      .then(o => alert('Zam√≥wienie #' + o.orderId + ' utworzone!'))\r\n      .catch(() => alert('B≈ÇƒÖd zam√≥wienia'));\r\n  };\r\n\r\n  if (!auth) return <div>≈Åadowanie...</div>;\r\n\r\n  return (\r\n    <div className=\"flex-container\">\r\n      <h1>Sklepik</h1>\r\n      <div className=\"products\">\r\n        <h2>Produkty</h2>\r\n        <ul>\r\n          {products.map(p =>\r\n            <li key={p.id}>\r\n              {p.name} ‚Äì {p.price.toFixed(2)} z≈Ç\r\n              <button onClick={() => addToCart(p)}>Dodaj</button>\r\n            </li>\r\n          )}\r\n        </ul>\r\n      </div>\r\n      <div className=\"cart\">\r\n        <h2>Koszyk</h2>\r\n        <ul>\r\n          {cart.map(c =>\r\n            <li key={c.productId}>\r\n              {c.name} x{c.qty} ‚Äì {(c.price * c.qty).toFixed(2)} z≈Ç\r\n            </li>\r\n          )}\r\n        </ul>\r\n        {cart.length > 0 && <>\r\n          <button onClick={checkout}>Zam√≥w</button>\r\n          <div className=\"cart-total\">\r\n            <strong>Suma: </strong>\r\n            {cart\r\n              .reduce((sum, c) => sum + c.price * c.qty, 0)\r\n              .toFixed(2)\r\n            } z≈Ç\r\n          </div>\r\n        </>}\r\n      </div>\r\n      <button onClick={() => keycloak.logout()}>Wyloguj</button>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}